<%- include('partials/header') %>

    <main>
        <section class="section">
            <div class="container">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: start;">
                    <div>
                        <img src="<%= product.images && product.images[0] ? product.images[0] : '/images/p1.jpeg' %>" alt="<%= product.name %>" style="width: 100%; border-radius: 10px; box-shadow: var(--shadow-lg);">
                    </div>
                    <div>
                        <h1 style="font-family: 'Playfair Display', serif; font-size: 2.5rem; margin-bottom: 1rem;">
                            <%= product.name %>
                        </h1>
                        <p style="color: var(--text-light); margin-bottom: 1.5rem; font-size: 1.1rem;">
                            <%= product.category %>
                        </p>
                        <div style="margin-bottom: 2rem;">
                            <span style="font-size: 2.5rem; font-weight: 700; color: var(--secondary-color);">Rs<%= product.price.toFixed(2) %></span>
                            <% if (product.originalPrice && product.originalPrice > product.price) { %>
                                <span style="font-size: 1.5rem; color: var(--text-light); text-decoration: line-through; margin-left: 1rem;">Rs<%= product.originalPrice.toFixed(2) %></span>
                                <% } %>
                        </div>
                        <p style="margin-bottom: 2rem; line-height: 1.8; color: var(--text-dark);">
                            <%= product.description %>
                        </p>

                        <% if (product.sizes && product.sizes.length > 0) { %>
                            <div class="form-group" style="margin-bottom: 1.5rem;">
                                <label>Size:</label>
                                <select id="product-size" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 5px;">
                            <% product.sizes.forEach(size => { %>
                            <option value="<%= size %>"><%= size %></option>
                            <% }); %>
                        </select>
                            </div>
                            <% } %>

                                <% if (product.colors && product.colors.length > 0) { %>
                                    <div class="form-group" style="margin-bottom: 1.5rem;">
                                        <label>Color:</label>
                                        <select id="product-color" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 5px;">
                            <% product.colors.forEach(color => { %>
                            <option value="<%= color %>"><%= color %></option>
                            <% }); %>
                        </select>
                                    </div>
                                    <% } %>

                                        <div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
                                            <button class="btn btn-add-cart" style="flex: 1; padding: 1rem; font-size: 1.1rem;" onclick="addToCart('<%= product._id %>', document.getElementById('product-size')?.value || '', document.getElementById('product-color')?.value || '')">Add to Cart</button>
                                            <button class="btn btn-wishlist" style="width: 60px; font-size: 1.5rem;" onclick="addToWishlist('<%= product._id %>')">♡</button>
                                        </div>

                                        <div style="background: var(--accent-color); padding: 1.5rem; border-radius: 10px;">
                                            <p style="margin-bottom: 0.5rem;"><strong>Stock:</strong>
                                                <%= product.stock %> available</p>
                                            <% if (product.stock === 0) { %>
                                                <p style="color: #f44336;">Out of Stock</p>
                                                <% } %>
                                        </div>
                    </div>
                </div>

                <% if (relatedProducts && relatedProducts.length > 0) { %>
                    <div style="margin-top: 5rem;">
                        <h2 class="section-title">Related Products</h2>
                        <div class="product-grid">
                            <% relatedProducts.forEach(product => { %>
                                <div class="product-card" onclick="window.location.href='/products/<%= product._id %>'">
                                    <img src="<%= product.images && product.images[0] ? product.images[0] : '/images/p1.jpeg' %>" alt="<%= product.name %>" class="product-image">
                                    <div class="product-info">
                                        <h3 class="product-name">
                                            <%= product.name %>
                                        </h3>
                                        <div class="product-price">
                                            Rs
                                            <%= product.price.toFixed(2) %>
                                        </div>
                                        <div class="product-actions">
                                            <button class="btn btn-add-cart" onclick="event.stopPropagation(); addToCart('<%= product._id %>')">Add to Cart</button>
                                            <button class="btn btn-wishlist" onclick="event.stopPropagation(); addToWishlist('<%= product._id %>')">♡</button>
                                        </div>
                                    </div>
                                </div>
                                <% }); %>
                        </div>
                    </div>
                    <% } %>
            </div>
        </section>
    </main>

    <%- include('partials/footer') %>